alert tcp any $HTTP_PORTS -> $HOME_NET any (msg:"getElementById et iframe "; flow:established,to_client; content:"getElementById"; nocase; content:"iframe"; nocase; content:"src"; nocase; classtype:attempted-user; reference:url,www.kahusecurity.com/2011/reversing-the-incognito-exploit-kit/; sid:2402843; rev:1;)
alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"TROJAN REDIRECT IN.CGI request"; flow:to_server,established; uricontent:"in.cgi?"; nocase; classtype:attempted-user; reference:url,bugtraq,45246; sid:2402844; rev:1;)
alert tcp $HOME_NET any -> any $HTTP_PORTS (msg:"JS request first"; flow:to_server,established; uricontent:".js"; nocase; classtype:attempted-user; flowbits:set,exp_kit; flowbits: noalert; reference:url,bugtraq,45246; sid:2402840; rev:1;)
alert tcp any $HTTP_PORTS -> $HOME_NET any (msg:"redirect by encoded http in hexa by call js"; flow:established,to_client; pcre:"/(\x5cx68\x5cx74\x5cx74\x5cx70|\x5cx3a\x5cx2f\x5cx2f)/iB"; flowbits:isset,exp_kit; classtype:attempted-user; reference:bugtraq,45246; sid:2402841; rev:1;)
alert tcp any $HTTP_PORTS -> $HOME_NET any (msg:"redirect by encoded http in hexa integred web site"; flow:established,to_client; pcre:"/\x5cx68\x5cx74\x5cx74\x5cx70/iB"; classtype:attempted-user; flowbits:isnotset,exp_kit; reference:bugtraq,45246; sid:2402842; rev:1;)


